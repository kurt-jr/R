---
title: "stat6021week2"
author: "Kurt"
date: "2024-07-22"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:
```{r}
library(tidyverse)
ggplot(startups, aes(R.D.Spend,Profit)) + geom_point()+ geom_smooth(method = lm, se = F)
model1 <- lm(Profit~R.D.Spend, data = startups)
coef(model1)  
```


```{r}
Bootstrap_estimates<-replicate(1000,{
bootstrap_samples <- startups[sample(1:nrow(startups),nrow(startups),replace = T),]
bootstrap_models <- lm(Profit~R.D.Spend, data = bootstrap_samples)
coef(bootstrap_models)
})
```
```{r}
estimates <- data.frame(t(Bootstrap_estimates))
estimates
ggplot(startups, aes(R.D.Spend,Profit)) + geom_point()+ geom_smooth(method = lm, se = F, color='blue')+
  geom_abline(data = estimates, aes(intercept = X.Intercept., slope = R.D.Spend), color = 'magenta')
```

```{r}
summarise(estimates, mean_b0=mean(X.Intercept.),mean_b1 = mean(R.D.Spend),na.rm = TRUE)
```
```{r}
model1.2 <- lm(Profit~R.D.Spend+Administration+Marketing.Spend,data = startups)
coef(model.2)
```
```{r}
## Multiple Regression based on (XtX)-1 Xty

X<-cbind(1,startups$R.D.Spend, startups$Administration,
        startups$Marketing.Spend)
XtX<-t(X)%*%X
inverse_XtX<-solve(XtX)

Xty<-t(X)%*%startups$Profit

beta<-inverse_XtX%*%Xty
```

```{r}
## Facet wrap scatterplot
Startups2<-gather(startups, key="predictor", value = "value",
                  R.D.Spend,Administration,Marketing.Spend)
```


Tuesday
```{r}
## Facet wrap scatterplot
long <- gather(startups, key = "predictor", value = "value", R.D.Spend, Administration, Marketing.Spend)
head(long)
ggplot(long, aes(value,Profit))+ geom_point()+facet_wrap(~predictor,scales = "free_x")
```

